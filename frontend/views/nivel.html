<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecci√≥n - TOO-EASY</title>
    
    <!-- ‚úÖ CSS CORREGIDOS -->
    <link rel="stylesheet" href="../public/css/flashcards.css">
    <link rel="stylesheet" href="../public/css/header.css">
</head>
<body>

<!-- ========================================
     ENCABEZADO CON NAVEGACI√ìN
     ======================================== -->
<header class="header">
    <div class="logo">
        <h1>TOO-EASY</h1>
        <p>JUEGA HOY, TRIUNFA MA√ëANA</p>
    </div>

    <nav class="nav">
        <a href="dashboard.html">DASHBOARD</a>
        <a href="retos.html">RETOS</a>
        <a href="lecciones.html">LECCIONES</a>
        <a href="perfil.html">PERFIL</a>
        <a href="#" id="logout-btn">
            <img src="../assets/icons/salida.png" alt="Salir" style="width: 24px; height: 24px;">
        </a>
    </nav>
</header>

<!-- ========================================
     CONTENEDOR PRINCIPAL DE FLASHCARDS
     ======================================== -->
<div class="container">

    <!-- ========================================
         HEADER: INFORMACI√ìN DEL NIVEL
         ======================================== -->
    <div class="lesson-header" style="text-align: center; margin-bottom: 30px;">
        <h1 id="lesson-title" style="color: #2C405B; margin-bottom: 10px;">
            üìö Cargando lecci√≥n...
        </h1>
        <p id="lesson-subtitle" style="color: #666; font-size: 1.1rem;">
            <!-- Ej: "Tema: Fundamentos - Nivel 1" -->
        </p>
    </div>

    <!-- ========================================
         TARJETA FLASHCARD (SE VOLTEA)
         ======================================== -->
    <div class="card" id="flashcard">
        <div class="card-inner">
            
            <!-- FRENTE DE LA TARJETA -->
            <div class="card-front">
                <h2 class="card-title" id="card-title-front">
                    T√≠tulo de la Lecci√≥n
                </h2>
                <img id="card-image" src="../assets/img/Imagen1.1.png" alt="Ilustraci√≥n">
            </div>

            <!-- REVERSO DE LA TARJETA -->
            <div class="card-back">
                <h2 class="title-back" id="card-title-back">
                    T√≠tulo de la Lecci√≥n
                </h2>
                <div class="container-info">
                    <p class="card-text" id="card-content">
                        Contenido educativo aqu√≠...
                    </p>
                </div>
            </div>

        </div>
    </div>

    <!-- ========================================
         CONTROLES DE NAVEGACI√ìN
         ======================================== -->
    
    <!-- Flechas para cambiar de tarjeta -->
    <button class="arrow-btn" id="prevCard" style="display: none;">
        ‚óÑ
    </button>
    <button class="arrow-btn" id="nextCard" style="display: none;">
        ‚ñ∫
    </button>

    <!-- Indicador de progreso -->
    <div style="text-align: center; margin-top: 20px;">
        <span id="card-counter" style="font-size: 1.1rem; color: #666;">
            <!-- Ej: "Tarjeta 1 de 5" -->
        </span>
    </div>

    <!-- ========================================
         BOTONES DE ACCI√ìN
         ======================================== -->
    <div class="buttons">
        <a href="lecciones.html" style="text-decoration: none;">
            <button class="btn-secondary">
                ‚Üê Volver a Niveles
            </button>
        </a>
        
        <button id="btn-ir-quiz" class="btn-primary" style="display: none;">
            Hacer Quiz ‚Üí
        </button>
    </div>

</div>

<!-- ========================================
     SCRIPT PARA LAS FLASHCARDS
     ======================================== -->
<script type="module">
    import { protectRoute, getAuthData } from '../public/js/modules/auth.js';

    // Proteger la ruta
    if (!protectRoute()) {
        throw new Error('No autenticado');
    }

    const sessionUser = getAuthData();

    // ========================================
    // DATOS DE LAS FLASHCARDS (Por Nivel)
    // ========================================
    const flashcardsData = {
        1: [
            {
                title: "¬øQu√© es el dinero?",
                image: "../assets/img/Imagen1.1.png",
                content: "El dinero es un medio de intercambio que usamos para comprar bienes y servicios. Puede ser f√≠sico (billetes y monedas) o digital (tarjetas y transferencias). Su valor est√° respaldado por la econom√≠a del pa√≠s."
            },
            {
                title: "Ingresos",
                image: "../assets/img/Imagen1.1.png",
                content: "Un ingreso es todo el dinero que entra a tu bolsillo o cuenta bancaria. Puede ser un salario, propinas, ventas, regalos o cualquier entrada econ√≥mica. Los ingresos pueden ser fijos (mensuales) o variables (ocasionales)."
            },
            {
                title: "Gastos",
                image: "../assets/img/Imagen1.1.png",
                content: "Los gastos son el dinero que sale de tu bolsillo para pagar cosas que necesitas o deseas. Se dividen en fijos (renta, luz) y variables (comida, entretenimiento). Controlar tus gastos es clave para tener salud financiera."
            }
        ],
        2: [
            {
                title: "El Arte de Ahorrar",
                image: "../assets/img/Imagen1.1.png",
                content: "Ahorrar es guardar una parte de tu dinero para el futuro. No significa dejar de disfrutar, sino planificar tus gastos para tener seguridad econ√≥mica y cumplir metas importantes como un viaje, estudios o emergencias."
            },
            {
                title: "¬øPor qu√© ahorrar?",
                image: "../assets/img/Imagen1.1.png",
                content: "El ahorro te da libertad financiera. Te permite enfrentar imprevistos sin endeudarte, cumplir sue√±os sin sacrificar tu calidad de vida y tener tranquilidad mental al saber que tienes un respaldo econ√≥mico."
            }
        ],
        3: [
            {
                title: "Fondo de Emergencia",
                image: "../assets/img/Imagen1.1.png",
                content: "Un fondo de emergencia es dinero guardado espec√≠ficamente para imprevistos: reparaciones, p√©rdida de empleo, gastos m√©dicos. Los expertos recomiendan tener ahorrado el equivalente a 3-6 meses de tus gastos b√°sicos."
            },
            {
                title: "Seguridad Financiera",
                image: "../assets/img/Imagen1.1.png",
                content: "La seguridad financiera significa tener control sobre tu dinero y no vivir al d√≠a. Se logra combinando: ingresos estables, control de gastos, ahorro constante y un fondo de emergencia que te proteja de situaciones inesperadas."
            }
        ]
        // A√±ade m√°s niveles aqu√≠ seg√∫n necesites
    };

    // ========================================
    // L√ìGICA DE LA APLICACI√ìN
    // ========================================
    
    // Obtener nivel desde URL (ej: nivel.html?level=1)
    const urlParams = new URLSearchParams(window.location.search);
    const nivelActual = parseInt(urlParams.get('level')) || 1;

    // Obtener flashcards del nivel
    const flashcards = flashcardsData[nivelActual] || [];
    
    if (flashcards.length === 0) {
        alert('Este nivel a√∫n no tiene contenido. Volviendo a lecciones...');
        window.location.href = 'lecciones.html';
    }

    let currentIndex = 0;

    // Referencias DOM
    const card = document.getElementById('flashcard');
    const cardInner = card.querySelector('.card-inner');
    const titleFront = document.getElementById('card-title-front');
    const titleBack = document.getElementById('card-title-back');
    const image = document.getElementById('card-image');
    const content = document.getElementById('card-content');
    const counter = document.getElementById('card-counter');
    const btnPrev = document.getElementById('prevCard');
    const btnNext = document.getElementById('nextCard');
    const btnQuiz = document.getElementById('btn-ir-quiz');
    const lessonTitle = document.getElementById('lesson-title');
    const lessonSubtitle = document.getElementById('lesson-subtitle');

    // Funci√≥n para obtener nombre del tema
    function getTemaYNivel(level) {
        if (level <= 3) return { tema: "Fundamentos", nivelEnTema: level };
        if (level <= 6) return { tema: "Cuentas Bancarias", nivelEnTema: level - 3 };
        if (level <= 10) return { tema: "Tarjetas", nivelEnTema: level - 6 };
        if (level <= 13) return { tema: "Administraci√≥n del Dinero", nivelEnTema: level - 10 };
        if (level <= 17) return { tema: "Deudas y Cr√©ditos", nivelEnTema: level - 13 };
        return { tema: "Desconocido", nivelEnTema: 1 };
    }

    const { tema, nivelEnTema } = getTemaYNivel(nivelActual);
    lessonTitle.textContent = flashcards[0].title;
    lessonSubtitle.textContent = `${tema} - Nivel ${nivelEnTema}`;

    // Funci√≥n para renderizar la tarjeta actual
    function renderCard() {
        const current = flashcards[currentIndex];
        
        titleFront.textContent = current.title;
        titleBack.textContent = current.title;
        image.src = current.image;
        content.textContent = current.content;
        counter.textContent = `Tarjeta ${currentIndex + 1} de ${flashcards.length}`;

        // Mostrar/ocultar flechas
        btnPrev.style.display = currentIndex > 0 ? 'flex' : 'none';
        btnNext.style.display = currentIndex < flashcards.length - 1 ? 'flex' : 'none';
        
        // Mostrar bot√≥n de quiz en la √∫ltima tarjeta
        btnQuiz.style.display = currentIndex === flashcards.length - 1 ? 'inline-block' : 'none';

        // Resetear volteo
        cardInner.classList.remove('flipped');
    }

    // Voltear tarjeta al hacer click
    card.addEventListener('click', () => {
        cardInner.classList.toggle('flipped');
    });

    // Navegaci√≥n
    btnPrev.addEventListener('click', (e) => {
        e.stopPropagation();
        if (currentIndex > 0) {
            currentIndex--;
            renderCard();
        }
    });

    btnNext.addEventListener('click', (e) => {
        e.stopPropagation();
        if (currentIndex < flashcards.length - 1) {
            currentIndex++;
            renderCard();
        }
    });

    // Ir al quiz
    btnQuiz.addEventListener('click', () => {
        window.location.href = `quiz.html?level=${nivelActual}`;
    });

    // Inicializar
    renderCard();

</script>

</body>
</html>